<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDH Command Center - Chatbot Analytics</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="background-aurora">
        <div class="orb orb1"></div>
        <div class="orb orb2"></div>
        <div class="orb orb3"></div>
    </div>

    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>IDH<span>Command</span></h1>
            </div>
            <nav class="sidebar-nav">
                <button id="nav-analytics" class="active">
                    <svg viewBox="0 0 24 24"><path d="M16,11V3H8v8H2l10,10L22,11H16z M10,5h4v14h-4V5z M4,13h4v6H4V13z M20,13h-4v6h4V13z"></path></svg>
                    <span>Analytics</span>
                </button>
                <button id="nav-users">
                    <svg viewBox="0 0 24 24"><path d="M12,12c2.2,0,4-1.8,4-4s-1.8-4-4-4s-4,1.8-4,4S9.8,12,12,12z M12,14c-2.7,0-8,1.3-8,4v2h16v-2C20,15.3,14.7,14,12,14z"></path></svg>
                    <span>User List</span>
                </button>
            </nav>
            <div class="sidebar-stats">
                <div class="stat-item">
                    <h3>Completion Rate</h3>
                    <div id="completion-rate-chart"></div>
                </div>
                 <div class="stat-item">
                    <h3>Active Status</h3>
                    <div id="status-chart"></div>
                </div>
            </div>
            <div class="sidebar-footer">
                <p>Internal Drift Holdings</p>
            </div>
        </aside>

        <main class="main-content">
            <div id="analytics-view" class="view active">
                <div class="main-header">
                    <h2>Overall Performance</h2>
                    <div class="kpi-card-flat">
                        <h3>Total Unique Users</h3>
                        <div class="value" id="kpi-total-users">0</div>
                    </div>
                </div>
                
                <div class="analytics-grid">
                    <div class="chart-container-full">
                        <h2>Daily User Activity</h2>
                        <div id="daily-activity-chart"></div>
                    </div>
                    <div class="chart-container-full">
                        <h2>Conversion Funnel</h2>
                        <div id="funnel-chart"></div>
                    </div>
                    <div class="chart-container-full">
                        <h2>Communication Preference</h2>
                        <div id="preference-pie-chart"></div>
                    </div>
                </div>
            </div>

            <div id="user-list-view" class="view">
                 <div class="main-header">
                    <h2>User Journey Records</h2>
                    <div class="toolbar-actions">
                        <input type="search" id="search-box" class="search-box" placeholder="Search by any user data...">
                        <button id="download-csv-btn" class="action-btn">
                            <svg viewBox="0 0 24 24"><path d="M19,9h-4V3H9v6H5l7,7L19,9z M5,18v2h14v-2H5z"></path></svg>
                            <span>Download CSV</span>
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead><tr><th>User ID</th><th>Furthest Step</th><th>Status</th><th>Last Activity</th></tr></thead>
                        <tbody id="user-table-body"></tbody>
                    </table>
                    <div id="loading-users" class="loading">Initializing Live Data Stream...</div>
                </div>
            </div>
        </main>
    </div>

    <!-- Libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="script.js"></script>

</body>
</html>